# 01-为什么说数据中台是大数据的下一站

从大数据的发展历史  
数据中台与数据仓库、数据湖、大数据平台的区别

## 数据仓库的出现

上个世纪 90 年代BI（Business Intelligence）商业智能出现，BI将企业已有的数据转化为知识，帮助企业做出经营分析决策。

而数据分析需要聚合多个业务系统的数据，比如交易系统、仓储系统的数据等，同时需要保存历史数据，进行大数据量的范围查询。  
传统数据库面向单一业务系统，主要实现的是面向事务的增删改查，已经不能满足数据分析的场景，促使数据仓库概念的出现。

数据仓库之父比尔·恩门（Bill Inmon）在 1991 年出版的《Building the Data Warehouse》中，首次给出了数据仓库的完整定义：

>数据仓库是在企业管理和决策中面向主题的、集成的、与时间相关的，不可修改的数据集合。

电商为例：

有一个数据库专门存放订单的数据，另外一个数据库存放会员相关的数据。  
构建数据仓库，首先要把不同业务系统的数据同步到一个统一的数据仓库中，然后按照**主题域**方式组织数据。

![image-20200405184016495](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/image-20200405184016495.png)

**主题域**是业务过程的一个高层次的抽象，像商品、交易、用户、流量都能作为一个主题域，可以理解为数据仓库的一个目录。  
数据仓库中的数据一般是按照时间进行分区存放，一般会保留 5 年以上，每个时间分区内的数据都是追加写的方式，对于某条记录是不可更新的。

Bill Inmon与Kimball金博尔共同开创了数仓建模的设计方法，对后来基于数据湖的现在数据仓库的设计有重要意义。  
恩门提出的建模方法自顶向下，顶为数据的来源，在传统数据库中，就是各个业务数据库。  
基于业务中各个实体以及实体之间的关系，构建数据仓库。

例如在一个最简单的买家购买商品的场景中，按照恩门建模模式，首先要理清业务过程中涉及哪些实体。  
买家、商品是一个实体，买家购买商品是一个关系。所以，模型设计应该有买家表，商品表，和买家商品交易表三个模型。

![image-20200405184001885](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/image-20200405184001885.png)

金博尔的建模方式与恩门相反，采用自底向上的模型设计方法，从数据分析的需求出发，拆分维度和事实，上面的例子中，用户、商品就是维度，库存、用户账户余额是事实。

![image-20200405184215053](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/image-20200405184215053.png)

两种方法各有优劣  
恩门建模是从数据源开始构建，构建成本比较高，适用于应用场景比较固定的业务，比如金融领域，优势是冗余数据少。  
金博尔建模从分析场景出发，适用于变化速度比较快的业务，比如互联网业务。

传统数据仓库明确了数据分析的应用场景应该用单独的解决方案去实现，不再依赖于业务数据库。但是进入互联网时代后传统数据仓库逐渐没落。

## Hadoop到数据湖

互联网时代的两个重要变化：

* 数据规模前所未有，传统数据仓库难以拓展，无法承载如此规模的海量数据
* 数据类型变得异构化，出了业务数据库的结构化数据，还有来自APP、web的前端埋点数据，或者业务服务器的后端埋点日志，这些数据一般是半结构化，或者是无结构。传统数据仓库对数据模型有严格要求，数据导入到数据仓库前，数据模型就必须先定义好，数据必须按照模型设计存储。

数据规模和数据类型的限制导致传统数据仓库无法支撑互联网时代的BI。

谷歌的分布式存储的三篇论文，提出了一种新的，面向数据分析的海量异构数据的统一计算、存储的方法，奠定了现代大数据的技术基础。

2005年Hadoop出现，相当于是三篇论文的开源实现，相比于传统数仓，有两个优势：

* 完全分布式，易于拓展，可以用低价的机器堆出一个计算、存储能力很强的集群，满足海量数据的处理要求；
* 弱化数据格式，数据被集成到 Hadoop 之后，可以不保留任何数据格式，数据模型与数据存储分离，数据在被使用时可以按照不同的模型读取，满足异构数据灵活分析的需求。

Hadoop技术成熟，2010年2010 年，Pentaho 创始人兼 CTO James Dixon 在纽约 Hadoop World 大会上提出了数据湖的概念：

>数据湖（Data Lake）是一个以原始格式存储数据的存储库或系统。

数据湖概念的提出可以认为是 Hadoop 从开源技术走向商业化成熟的标志。企业可以基于 Hadoop 构建数据湖，将数据作为一种企业核心资产。

但是一个商用的 Hadoop 包含 20 多种计算引擎， 数据研发涉及流程非常多，技术门槛限制了 Hadoop 的商用化进程，新的需求：需要将数据加工在流水线工厂一样。

## 大数据平台兴起

一个数据开发完成需求的常见流程：

把数据导入到大数据平台中，按照需求进行数据开发。  
开发完成后进行数据验证比对，确认是否符合预期。  
把数据发布上线，提交调度。  
最后是日常的任务运维，确保任务每日能够正常产出数据。  
数据集成、数据开发、数据测试、数据发布、任务运维以此往复迭代。

这个工作流需要高效的平台进行支撑，大数据平台概念的兴起就是为了提高数据研发的效率，降低数据研发的门槛，让数据可以快速加工。

> 大数据平台是面向数据研发场景的，覆盖数据研发的完整链路的数据工作台

大数据平台按照使用场景，分为数据集成、数据开发、数据测试……任务运维，大数据平台的使用对象是数据开发。大数据平台的底层是以 Hadoop 为代表的基础设施，分为计算、资源调度和存储。

Hive、Spark、Flink、Impala 提供了大数据计算引擎：

* Hive、Spark 主要解决离线数据清洗、加工的场景，目前，Spark 用得越来越多，性能要比 Hive 高不少；
* Flink 主要是解决实时计算的场景；
* Impala 主要是解决交互式查询的场景。

这些计算引擎统一受资源调度管理框架Yarn分配计算资源。最新的研究方向中也有基于 Kubernetes 实现资源调度，例如在最新的 Spark 版本（2.4.4）中，Spark 已经能够运行在 Kubernetes 管理的集群上，好处是可以实现在线和离线的资源混合部署，节省机器成本。

数据存储在 HDFS、Kudu 和 HBase 系统内。  
HDFS 不可更新，主要存全量数据，HBase 提供了一个可更新的 KV（KeyValue），主要存一些维度表，Kudu 提供了实时更新的能力，一般用在实时数仓的构建场景中。

经过数据平台的加工，原始数据成为指标，出现在各个报表或者数据产品中，但是数据需求快速增长，指标、数据模型越来越多，伴随的问题也越来越多：找不到数据、数据不好用、数据需求响应速度慢等。

## 数据中台崛起

2016年后，互联网高速发展背后的数据需求越来越多，数据的应用场景也越来越多，大量数据产品进入到日常运营工作。

大规模数据的应用也逐渐暴露一些问题：

业务发展前期为快速实现业务需求，烟囱式开发导致企业不同业务线、相同业务线不同应用之间的数据是割裂的。  
两个数据应用的相同指标，展示的结果不一致，导致运营对数据的信任度下降。

数据割裂还会带来大量的重复计算、开发，导致的研发效率的浪费，计算、存储资源的浪费，大数据的应用成本越来越高。不同运营、数据开发、企业老板面对数据需求各有问题。

问题的根源在于数据无法共享。

2016年阿里率先提出了数据中台的口号，**数据中台的核心是避免数据的重复计算，通过数据服务化，提高数据的共享能力，赋能数据应用。**



数据中台是大数据的下一站的原因：

* 数据中台构建于数据湖之上，具备数据湖异构数据统一计算、存储的能力，同时让数据湖中杂乱的数据通过规范化的方式管理起来。
* 数据中台需要依赖大数据平台，大数据平台完成了数据研发的全流程覆盖，数据中台增加了数据治理和数据服务化的内容。
* 数据中台借鉴了传统数据仓库面向主题域的数据组织模式，基于维度建模的理论，构建统一的数据公共层。



补充链接:[大数据发展史]([https://github.com/woleirenlai/DataScience/blob/master/Geekbang%E4%B8%93%E6%A0%8F/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E5%A4%A7%E6%95%B0%E6%8D%AE/00-01-02%E5%BC%80%E7%AF%87%26%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%8F%91%E5%B1%95%E5%8F%B2.md])
