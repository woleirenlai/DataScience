# 05-如何管理纷繁杂乱的数据指标

元数据在指标管理、模型设计、数据质量和成本治理四个领域都发挥着作用，而这些领域构成了数据中台 OneData 数据体系。

指标是一种特定类型的元数据，是业务和数据的交汇点。

指标口径不统一，会导致相同名称的指标数值相差很大。

数据中台需要构建全局一致的指标口径，输出企业的指标字典。

## 指标混乱现状

常见的指标问题：

![01](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/01.jpg)

口诀：

同名不同径，同径不同名。  
口径不清晰，口径有错误。  
命名难理解，计算不易懂。  
来源不清晰，同部不同径。

**相同指标名称，口径定义不同**

例如不同的部门对相同的“新用户销售额”，市场部门认定新用户是首次下单并完成支付的用户，会员中心认定新用户是当日新注册用户。  
相当于市场部门认定的新用户中，可能有之前注册但是没有下过单的客户，而会员中心只包括当日注册并完成下单支付的用户

口径不一致，数据也就没办法横向对比，失去了数据辅助商业决策的意义。

**相同口径，指标名称不同**

两个数据指标口径定义并没有区别，但是指标名称不同，会让使用指标的人疑惑。

**不同限定词，描述相同事实过程的两个指标，相同事实部分口径不一致**

比如：黑卡会员购买用户和非会员购买用户数，描述的都是用户下单购买商品的同一过程，记录的都是购买商品的事实，只是一个限定词是黑卡会员，一个限定词是非会员。

这虽然是两个指标，但是对于“购买用户数”这个事实部分，业务口径、计算逻辑应该是一致的，但是现实情况却可能是：

“黑卡会员购买用户数”：计算周期内去重的（重复购买的用户只算一个），下单并且支付成功的用户数量；  
 非会员的购买用户数”：计算周期内去重的，下单并且支付成功，排除关单（“关单”是指在用户在下单购买成功后，取消订单）的用户数量。

也就是对于购买用户数，这两个指标一个包含关单，一个不包含关单。

**指标口径描述不清晰**

报表指标口径描述笼统：比如“关单金额”，口径描述“关闭订单的金额”。

可以是支付成功后关闭订单；也可以是支付完成前，取消订单。  
描述不清晰，就会对数据理解产生歧义。

**口径描述错误**

例如流量分析数据产品，“7 日 uv”，口径的定义是 7 日内日均 uv。  
口径描述的计算逻辑应该是最近 7 日，每日 uv 相加除以 7 取平均值。

但是业务场景中正确的 7 日 uv 的口径定义应该是 7 日内有登录过，去重的用户数。

**指标命名难于理解**

比如有一个指标名称是“ROI”，口径定义优惠券销售额 / 优惠券成本。

但是ROI 其实是投资回报率的简称，在电商业务场景中，除了优惠劵，商品降价促销都可以计算 ROI。

好的命名应该是（商品|类目|通用）优惠劵 ROI。

指标命名不规范从指标名称中很难看出指标描述的业务过程。

**指标数据来源和计算逻辑不清晰**

指标数据来源不清楚，一旦指标数据异常会很难溯源。  
还有一些指标的计算逻辑比较复杂，仅仅凭借业务口径一段描述，使用指标的人还是无法理解这个指标的计算逻辑，这个时候就需要有一些伪码或者 SQL 描述。

## 如何规范化定义指标

![03](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/03.jpg)

高效、规范化管理指标

**面向主题域管理**

按照业务线、主题域、业务过程三级目录方式管理指标（业务线是顶级目录）提高指标管理效率

比如网易的业务线：电商、游戏、音乐、传媒、教育。  
业务线之下是主题域，指标中的主题域与数仓中的概念一致，划分标准最好跟数仓保持一致。  
主题域西面有细分的业务过程，比如交易域细分业务过程：加购、下单、支付。

**拆分原子指标和派生指标**

对于 不同限定词，描述相同事实过程的两个指标，相同事实部分口径不一致 的问题，需要引入原子指标和派生指标进行管理。

![04](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/04.jpg)

统计周期、统计粒度、业务限定、原子指标，组成派生指标，原子指标即不能按这个规则拆分的指标。

例如图例中：  

* 购买用户数是原子指标，口径定义：计算周期内去重的，下单并且支付成功的用户数量，包括关单；
* 黑卡会员和非会员认定为业务限定词；
* 统计粒度为商品粒度；
* 统计周期为 30 天。

那么 30 天内，按照商品维度的 黑卡会员购买用户数 与 30 天内商品维度的非会员购买用户数 就是继承购买用户数这个原子指标的两个派生指标。

**命名规范**

指标命名遵循的原则：

* 易懂：看到指标的名称，可基本判断这个指标归属于哪个业务过程；
* 统一：确保派生指标和它继承的原子指标命名一致。

另外指标应该有指标名称和指标表示（英文名）。

原子指标的指标名称适合用 动作 + 度量 进行命名，例如注册用户数、购买用户数，标识使用英文简写或汉语拼音缩写。

派生指标的命名需严格遵循 时间周期 + 统计粒度 + 修饰词 + 原子指标 进行命名，标识使用 修饰词 _ 原子指标 _ 时间周期。

![05](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/05.jpg)

**关联的应用和可分析维度**

使用指标的运营或分析师了解指标的口径下一步就是看对应数据，所以全局的指标字典中还需要：

* 指标被哪些应用使用，方便对应的数据产品或报表上查看指标的数值。
* 指标的可分析维度，方便分析师从不同的维度分析指标的变化趋势。

**分等级管理**

不光数据中台会产出一些公共核心指标，业务部门也会创建一些专属的部门内指标，众多指标的管理可以进行区分等级进行管理：

* 一级指标：数据中台直接产出，核心指标（给公司高层看）、原子指标、跨部门的派生指标，进行管理时要确保指标按时、保证质量产出，指标创建由中台负责；
* 二级指标：基于中台提供的原子指标，业务部门创建的派生指标，进行管理时允许业务方自己创建，中台不承诺指标的产出时间和质量。

## 指标系统

Excel不是一个适合指标管理的工具，主要是因为南与共享、缺少权限控制、无法动态灯芯、指标无法跟数仓的模型动态关联。

面向指标的管理系统，是基于元数据中心构建的指标管理工具，从元数据中心自动同步数仓的主题域和业务过程，按照规范化定义创建指标。

![06](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/06.jpg)

新创建的指标同时以特定类型的标签下沉到元数据中心对应的表和字段上，在数据地图上就可以搜索到表关联的指标。

![07](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/07.jpg)

同时还需要提供按指标名称、标识、业务口径进行检索。

![08](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/08.jpg)

## 基于指标系统构建全局的指标字典

指标治理的最终结果要形成一个全局业务口径一致的指标字典。指标使用者可以通过指标字典快速了解指标的业务含义和计算过程，不会对指标口径产生歧义。

数据中台团队必须要有一个专门负责指标管理的人或者小组（一般不超过 3 个人），最好是数据产品经理来负责，也可以让分析师承担（分析师必须属于中台团队）。

构建全局的指标字典分为两个场景：

### 新的指标需求，如何基于指标系统完成指标开发流程。

![09](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/09.jpg)

图中包括了新建指标的流程、参与的角色，需要强调：

* 指标需求评审，需要需求方、数据开发、应用开发都参加。  
  评审首先要确认这是不是一个新的指标，并明确它是原子指标还是派生指标。评审的目的就是要大家达成一致。
* 评审的结果一种是不需要开发，是一个已经存在的指标，直接可以通过设计逻辑模型（具体我会在数据服务章节讲），发布接口，获取数据。第二种就是需要开发。前者交付时间短，后者需要排期，交付时间长。
* 指标有一级和二级之分，这个流程适用于一级指标，对于二级指标，可以不需要评审，开发也是由业务方开发和发布上线。

### 已经存在的、混乱的指标现状如何进行全局梳理。

进行一次全局指标梳理的步骤：

* 成立以数据产品或者分析师为核心的 1～3 人的工作小组，专门负责指标的全局梳理；

* 制定指标梳理计划，明确指标梳理目标，覆盖多少个业务线，与业务方共同制定时间计划；

* 对于每一个业务线，需要对还在使用的数据报表、数据产品进行盘点，顺便可以把没用的报表和数据产品下线；

* 对于每一个报表和数据产品中涉及的指标，按照以下格式进行收集；

  ![10](https://github.com/woleirenlai/Images/blob/master/shujuzhongtai/05/10.jpg)

* 对于收集的指标，明确业务口径，对于口径相同的，应该去除重复，关联的应用应该合并，此时以我的经验，可以过滤掉相当一部分；
* 根据指标业务口径，明确指标所属的主题域、业务过程；
* 区分指标类型，对于派生指标，要明确指标的统计粒度、修饰词、时间周期以及关联的原子指标；
* 按照指标系统对指标的规范化定义，把整理好的指标录入指标系统。



通过全局的梳理和新建指标流程的管控，就可以构建一个全局一致的指标字典了。